<MainLayout name="bridge.01">
  <RequiredInput name="start" comment="Starting point of the bridge" />
  <RequiredInput name="end" comment="End point of the bridge" />
  <RequiredInput name="width" comment="Width of the bridge" />
  
  <Material id="1" file="..\content\textures\dirt.png" />
  <Material id="2" file="..\content\textures\stone01.jpg" />
  <Variable name="color" value="(1;1;1;1)" />

  <Variable name="xLen" value="end[0]-start[0]" />
  <Variable name="yLen" value="end[1]-start[1]" />
  <Variable name="center" value="(start[0] + 0.5 * xLen; start[1] + 0.5 * yLen)" />
  <Variable name ="length" value="sqrt(xLen^2 + yLen^2)" />
  <Variable name="angle" value="-atan(yLen/xLen)" />
  <Variable name="ang2" value="pi/2+atan(xLen/yLen)" />
  <Variable name="nrOfElements" value="round(length / 2)" />
  <Variable name="elementLen" value="length / nrOfElements" />
  <Variable name="height" value="optional(bridgeheight, world->height(start[0], start[1]))" />

  <Layout pos="0;height;0">
  
    <Layout pos="center[0];-0.11;center[1]" rot="0;angle;0">
      <Instruction value="BO:Box:(0;0;0);(length;0.2;width);1;color" />
      <Instruction value="BO:Box:(-length/2+1;-1.29;0);(2;2;width+1.25);2;color" />
      <Instruction value="BO:Box:(length/2-1;-1.29;0);(2;2;width+1.25);2;color" />
    </Layout>
    
    <Layout pos="center[0];-0.4;center[1]" rot="0;ang2;0">
      <Layout pos="-length/2+elementLen/2;0;width/2+0.3" type="array" param1="nrOfElements" variables="elementLen;0;0;0;0;0">
        <Layout type="fileinstance" instancename="..\\content\\models\\bridge_element01.xml">
          <Input name="texture" type="string" value="../content/texture/metal03.jpg" />
          <Input name="length" value="elementLen" />
        </Layout>
      </Layout>
    </Layout>
    
    <Layout pos="center[0];-0.4;center[1]" rot="0;pi+ang2;0">
      <Layout pos="-length/2+elementLen/2;0;width/2+0.3" type="array" param1="nrOfElements" variables="elementLen;0;0;0;0;0">
        <Layout type="fileinstance" instancename="..\\content\\models\\bridge_element01.xml">
          <Input name="texture" type="string" value="../content/texture/metal03.jpg" />
          <Input name="length" value="elementLen" />
        </Layout>
      </Layout>
    </Layout>

  </Layout>
  

</MainLayout>