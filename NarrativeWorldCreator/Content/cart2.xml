<?xml version="1.0" encoding="us-ascii"?>
<MainLayout name="Wooden push cart">
  <Material id="0" file="..\\content\\textures\\wheels.dds" remap="0;0;0.5;0.5" transparency="0.01" />
  <Material id="1" file="..\\content\\textures\\wheels.dds" remap="0.5;0;0.5;0.5" transparency="0.01" />
  <Material id="2" file="..\\content\\textures\\wheels.dds" remap="0;0.5;0.5;0.5" transparency="0.01" />

  <Material id="3" file="..\\content\\textures\\wood02.dds" />
  <Material id="4" file="..\\content\\textures\\wood02b.dds" />
  <Material id="5" file="..\\content\\textures\\wood05.dds" />
  
  <Material id="6" file="..\\content\\textures\\barrel.dds" />

  <Variable name="wheelTex" value="rand('dice', 0, 2)" />
  <Variable name="woodTex" value="rand('dice', 3, 5)" />

  <Variable name="width" value="rand('const', 0.8, 1.25)" />
  <Variable name="length" value="rand('const', 1.5, 2.75)" />
  <Variable name="height" value="rand('const', 0.75, 0.9)" />

  <Variable name="bottomType" value="rand('dice',0,3)" />
  <Variable name="color" value="(1;1;1;1)" />

  <Layout rot="0;0;0">
    <Instruction value="BO:Box:(0;height+0.025;0);(length;0.05;width);woodTex;color" />

    <Layout type="conditional" condition="bottomType==0">
      <Variable name="numWheels" value="if(length>1.5,2,rand('dice', 1, 2))" />

      <Layout type="array" param1="2" pos="0;0;-width*0.5+0.1" variables="0;0;width-0.2;0;0;0">
        <Layout type="array" param1="numWheels" pos="-(numWheels-1)*0.5*(height+0.1);0;0" variables="height+0.1;0;0;0;0;0">
          <Instruction value="BO:Mesh:'grid';1;(-height*0.5;0;0);(-height*0.5;height;0);(height*0.5;height;0);(height*0.5;0;0);(('i==0');('i==size');('j==size'));'0';wheelTex" />
        </Layout>
      </Layout>
    </Layout>
    
    <Layout type="conditional" condition="bottomType==1">
      <Layout type="array" param1="2" pos="-length*0.5+0.25;0;0" variables="length-0.5;0;0;0;0;0">
        <Instruction value="BO:Cylinder:0;0;0;height;0.25;0.25;10;6" />
      </Layout>
    </Layout>

    <Layout type="conditional" condition="bottomType==2">
      <Instruction value="BO:Box:(-length*0.5+0.05;height*0.5;-width*0.5+0.05);(0.05;height;0.05);woodTex;(1;1;1;1)" />
      <Instruction value="BO:Box:( length*0.5-0.05;height*0.5;-width*0.5+0.05);(0.05;height;0.05);woodTex;(1;1;1;1)" />
      <Instruction value="BO:Box:( length*0.5-0.05;height*0.5; width*0.5-0.05);(0.05;height;0.05);woodTex;(1;1;1;1)" />
      <Instruction value="BO:Box:(-length*0.5+0.05;height*0.5; width*0.5-0.05);(0.05;height;0.05);woodTex;(1;1;1;1)" />
    </Layout>

    <Layout type="conditional" condition="bottomType==3">
      <Variable name="ang" value="atan(height/0.1)" />
      <Variable name="len" value="0.1/cos(ang)" />
      <Layout type="array" param1="2" pos="0;0;-width*0.5+0.1" variables="0;0;width-0.2;0;0;0">
        <Layout type="array" param1="2" pos="-length*0.5+0.15;0;0" variables="length-0.3;0;0;0;0;0">
          <Layout pos="0;height*0.5;-0.05" rot="ang;0;0">
            <Instruction value="BO:Box:(0;0;0);(0.1;0.02;len);woodTex;(1;1;1;1)" />
          </Layout>
          <Layout pos="0;height*0.5;0.05" rot="-ang;0;0">
            <Instruction value="BO:Box:(0;0;0);(0.1;0.02;len);woodTex;(1;1;1;1)" />
          </Layout>
        </Layout>
      </Layout>
    </Layout>

    <Layout pos="0;height+0.05;0">
      <Variable name="size" value="rand('const',0.5,1.5)" />
      <Layout type="fileinstance" instancename="..\\content\\models\\marketstallGoods.xml">
        <Input name="width" value="width" />
        <Input name="length" value="length" />
      </Layout>
      <Layout type="conditional" condition="rand('dice',0,1)==0">
        <Layout type="fileinstance" instancename="..\\content\\models\\marketstalltop.xml">
          <Input name="width" value="width" />
          <Input name="length" value="length" />
          <Input name="height" value="rand('const',0.9,1.05)" />
        </Layout>
      </Layout>
    </Layout>
  </Layout>

</MainLayout>